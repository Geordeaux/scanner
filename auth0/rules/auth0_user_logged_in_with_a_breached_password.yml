# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: Auth0 user logged in with a breached password
description: |-
  ## Goal
  Detect when a user logs in with a breached password.

  ## Strategy
  1. Check if MFA was prompted and successful.
  2. Investigate the source IP for other malicious activity.

  ## Triage and Response
  1. Identify the user (`data.user_id`).
  2. Check if the login was successful.
  1. Force a password reset for the user immediately.
  2. Enforce MFA if not already enabled.
  3. Educate the user on password hygiene (not reusing passwords).
enabled: true
severity: Medium
query_text: |-
  %ingest.source_type:auth0
  data.type:pwd_leak
  | groupbycount(data.user_id)
  | where @q.count > 0
time_range_s: 300
run_frequency_s: 60
event_sink_keys:
- medium_severity_alerts
tags:
- techniques.t1078.valid_accounts
- source.auth0
- tactics.ta0001.initial_access
