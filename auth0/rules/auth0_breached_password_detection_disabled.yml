# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: Auth0 breached password detection disabled
description: |-
  ## Goal
  Detect when breached password detection in Auth0 is disabled.

  ## Strategy
  1. Determine if this was an authorized change (e.g., testing, new policy).
  2. Contact the application owner or tenant admin to verify.
  3. Check if other security settings were disabled around the same time.

  ## Triage and Response
  1. Identify the client ID (`data.client_id`) and user (`data.user_id`) responsible for the change.
  2. Check the timestamp and source IP.
  1. If unauthorized, re-enable breached password detection immediately.
  2. Investigate the user account that performed the action for compromise.
  3. Review logs for any suspicious logins that occurred while the protection was disabled.
enabled: true
severity: Medium
query_text: |-
  %ingest.source_type:auth0
  data.type:sapi
  data.details.request.path:/api/v2/attack-protection/breached-password-detection
  data.details.response.body.enabled:false
  | groupbycount(data.client_id)
  | where @q.count > 0
time_range_s: 300
run_frequency_s: 60
event_sink_keys:
- medium_severity_alerts
tags:
- source.auth0
- techniques.t1562.impair_defenses
- tactics.ta0005.defense_evasion
