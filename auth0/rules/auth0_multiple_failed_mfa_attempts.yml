# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: Auth0 Multiple Failed MFA Attempts
description: |-
  ## Goal
  Detects multiple failed Multi-Factor Authentication (MFA) attempts for a single
  user. This may indicate an attacker attempting to bypass MFA or a user
  experiencing issues with their MFA device.

  ## Strategy
  1. Contact the user to check if they are having trouble logging in.
  2. Check if the password was recently changed.
  3. Investigate the source IP for other malicious activity.

  ## Triage and Response
  1. Identify the user (`data.user_id`) and the source IP.
  2. Check the number of failed attempts.
  1. If the user confirms it wasn't them, reset their password immediately.
  2. Block the attacking IP.
  3. Review the user's MFA enrollment status.
enabled: true
severity: Medium
query_text: |-
  %ingest.source_type:auth0
  data.type:gd_auth_failed
  | groupbycount(data.user_id)
  | where @q.count > 3
time_range_s: 300
run_frequency_s: 60
event_sink_keys:
- medium_severity_alerts
tags:
- tactics.ta0006.credential_access
- techniques.t1110.brute_force
- source.auth0
