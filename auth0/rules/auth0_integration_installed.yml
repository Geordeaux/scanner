# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: Auth0 Integration Installed
description: |-
  ## Goal
  Detect when an integration is installed in Auth0, which may
  introduce security risks.

  ## Strategy
  1. Determine if this installation was authorized.
  2. Review the permissions requested by the integration.

  ## Triage and Response
  1. Identify the user (`data.user_id`) and the integration installed.
  2. Check the timestamp and source IP.
  1. If unauthorized, remove the integration immediately.
  2. Investigate the user account.
  3. Revoke any API keys or tokens generated for the integration.
enabled: true
severity: Informational
query_text: |-
  %ingest.source_type:auth0
  data.description:'Install an available integration'
  data.details.request.path:/api/v2/integrations/installed
  data.details.request.channel:'https://manage.auth0.com'
  | groupbycount(data.user_id)
  | where @q.count > 0
time_range_s: 300
run_frequency_s: 60
event_sink_keys:
- informational_severity_alerts
tags:
- tactics.ta0002.execution
- techniques.t1059.command_and_scripting_interpreter
- source.auth0
