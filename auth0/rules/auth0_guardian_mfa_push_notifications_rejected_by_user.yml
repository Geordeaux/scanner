# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: Auth0 Guardian MFA Push Notifications Rejected by User
description: |-
  ## Goal
  Detect when multiple Auth0 Guardian multi-factor authentication (MFA)
  push notifications are rejected by a user.

  ## Strategy
  1. Confirm if the user is actively rejecting these requests (contact them).
  2. Check if there was eventually a successful login (MFA bypass).
  3. Investigate the source IP of the login attempts.

  ## Triage and Response
  1. Identify the user (`data.user_id`) and the source IP of the login attempts.
  2. Check the number of rejected attempts.
  1. Reset the user's password immediately (since the attacker likely has it).
  2. Block the attacking IP.
  3. Educate the user about MFA fatigue attacks.
enabled: true
severity: High
query_text: |-
  %ingest.source_type:auth0
  data.type:gd_auth_rejected
  | groupbycount(data.user_id)
  | where @q.count > 10
time_range_s: 300
run_frequency_s: 60
event_sink_keys:
- high_severity_alerts
tags:
- tactics.ta0006.credential_access
- techniques.t1621.multi_factor_authentication_request_generation
- source.auth0
