# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: Auth0 Brute Force Attack on User
description: |-
  ## Goal
  Detect a potential brute force attack by monitoring failed login attempts from the same Auth0 user.

  ## Strategy
  1. Check if the IP is known malicious (threat intel).
  2. Check if other users are being targeted by the same IP (password spraying).
  3. Verify if the user has MFA enabled.

  ## Triage and Response
  1. Identify the targeted user (`data.user_id`) and the source IP(s).
  2. Check the volume and duration of failed attempts.
  3. Check if there was a successful login from the same IP after the failed attempts.
  1. Block the attacking IP address in Auth0 or at the firewall.
  2. Reset the user's password.
  3. Enforce MFA for the user if not already enabled.
  4. Notify the user of the suspicious activity.
enabled: true
severity: Medium
query_text: |-
  %ingest.source_type:auth0
  data.type:(fp fu)
  | groupbycount(data.user_id)
  | where @q.count > 5
time_range_s: 300
run_frequency_s: 60
event_sink_keys:
- medium_severity_alerts
tags:
- tactics.ta0006.credential_access
- techniques.t1110.brute_force
- source.auth0
