# schema: https://scanner.dev/schema/scanner-threat-hunting-query.v1.json
name: Auth0 High-Privilege Role Assigned
description: |-
  Detects when a role is assigned to a user in Auth0. This activity should be
  monitored to prevent unauthorized privilege escalation, especially if the role
  grants administrative access.
query_text: |-
  %ingest.source_type:auth0
  data.type:sapi
  data.description:"Assign roles to a user"
  data.details.request.path:/api/v2/users/*/roles
  | groupbycount(data.user_id)
  | where @q.count > 0
tags:
- tactics.ta0004.privilege_escalation
- techniques.t1098.account_manipulation
- source.auth0
