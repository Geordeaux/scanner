# schema: https://scanner.dev/schema/scanner-threat-hunting-query.v1.json
name: Auth0 Client Secret Rotated or Created
description: |-
  Detects when a client secret is rotated or created in Auth0. Attackers may
  rotate secrets to maintain persistence or gain unauthorized access to
  applications.
query_text: |-
  %ingest.source_type:auth0
  data.type:sapi
  (
  (data.description:"Rotate a client secret") or
  (data.description:"Create a client secret")
  )
  data.details.request.path:/api/v2/clients/*/rotate-secret
  | groupbycount(data.user_id)
  | where @q.count > 0
tags:
- tactics.ta0003.persistence
- techniques.t1098.account_manipulation
- source.auth0
