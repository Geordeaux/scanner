# schema: https://scanner.dev/schema/scanner-threat-hunting-query.v1.json
name: An AWS S3 bucket lifecycle expiration policy was set to disabled
description: |-
  Detect if an AWS S3 lifecycle expiration policy is disabled in your CloudTrail logs.
query_text: |-
  (not errorCode:*)
  eventSource:s3.amazonaws.com
  eventName:PutBucketLifecycle
  requestParameters.LifecycleConfiguration.Rule.Expiration:*
  requestParameters.LifecycleConfiguration.Rule.Status:Disabled
  | groupbycount(requestParameters.bucketName)
  | where @q.count > 0
tags:
- source.cloudtrail
- techniques.t1562.impair_defenses
- tactics.ta0005.defense_evasion
