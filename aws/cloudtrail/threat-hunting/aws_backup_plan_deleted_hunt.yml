# schema: https://scanner.dev/schema/scanner-threat-hunting-query.v1.json
name: AWS Backup Plan Deleted
description: |-
  Detect deletions of AWS Backup Plans or Backup Selections.
query_text: |-
  %ingest.source_type="aws:cloudtrail"
  eventSource="backup.amazonaws.com"
  eventName:(
  "DeleteBackupPlan"
  "DeleteBackupSelection"
  )
  and not errorCode:*
  | stats
  min(timestamp) as firstTime,
  max(timestamp) as lastTime,
  count() as eventCount
  by
  recipientAccountId,
  userIdentity.arn,
  eventSource,
  eventName,
  awsRegion,
  requestParameters.backupPlanId,
  requestParameters.backupPlanName,
  requestParameters.selectionId
tags:
- source.aws
- domain.cloud
- tactics.ta0040.impact
- techniques.t1490.inhibit_system_recovery
- use_case.aws_backup
- use_case.resilience
