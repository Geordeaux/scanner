# schema: https://scanner.dev/schema/scanner-threat-hunting-query.v1.json
name: AWS Successful Console Authentication From Multiple IPs
description: |-
  Detect when an AWS user successfully authenticates from more than one unique IP address within 5 minutes, which may indicate account compromise or unauthorized access.
query_text: |-
  %ingest.source_type="aws:cloudtrail"
  eventSource:"signin.amazonaws.com"
  eventName:ConsoleLogin
  responseElements.ConsoleLogin:"Success"
  | groupbycount(
  userIdentity.arn,
  sourceIPAddress
  )
  | groupbycount(
  userIdentity.arn
  )
  | where @q.count > 1
tags:
- source.aws
- domain.cloud
- domain.auth
- tactics.ta0042.resource_development
- techniques.t1586.compromise_accounts
- use_case.account_compromise
- use_case.impossible_travel_like
