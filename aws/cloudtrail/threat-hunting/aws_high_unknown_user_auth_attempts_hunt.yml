# schema: https://scanner.dev/schema/scanner-threat-hunting-query.v1.json
name: AWS High Number Of Unknown User Authentication Attempts
description: |-
  Detects when a high number of failed authentication attempts occur for unknown users. This may indicate credential stuffing or brute force activity against the AWS Console.
query_text: |-
  %ingest.source_type="aws:cloudtrail"
  eventSource:"signin.amazonaws.com"
  eventName:"ConsoleLogin"
  responseElements.ConsoleLogin:"Failure"
  errorMessage:"No username found in supplied account"
  | groupbycount(
  sourceIPAddress,
  recipientAccountId
  )
  | where @q.count >= 10
tags:
- source.aws
- domain.cloud
- domain.identity_and_access
- tactics.ta0006.credential_access
- techniques.t1110.brute_force
- use_case.auth_bruteforce
- use_case.cloud_console_authentication
