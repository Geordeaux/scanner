name: AWS Privilege Escalation Using IAM Login Profile Playbook
description: Detect when a user creates or updates a login profile for another user
  and then a successful AWS Console login is performed from the same IP address within
  a short time window. This can indicate an attempt to escalate privileges by unauthorized
  users.
severity: Low
steps:
- name: Investigation
  description: 'Monitor AWS CloudTrail events for:

    * IAM login profile changes via `CreateLoginProfile` or `UpdateLoginProfile` from
    `iam.amazonaws.com`.

    * Successful AWS Console logins via `ConsoleLogin` from `signin.amazonaws.com`.


    Identify source IP addresses that perform both a login profile change and at least
    one successful console login in the same account within the rule time window.
    This heuristic indicates that the same IP both modified login profiles and logged
    into the console, which may represent privilege escalation using a newly enabled
    credential.'
- name: Triage
  description: '* Confirm whether the login profile change and subsequent console
    login were part of an approved change (for example, a helpdesk or break-glass
    procedure).

    * Validate that the actor principal is authorized to manage IAM login profiles
    for the affected account.

    * Review which user(s) logged in from the same IP and whether that usage is expected
    (e.g. admin workstation vs. unfamiliar IP).

    * If suspicious, revoke or rotate affected credentials, enforce MFA, and review
    additional activity from the same IP and principals.'
