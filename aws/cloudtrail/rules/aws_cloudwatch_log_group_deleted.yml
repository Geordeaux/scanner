# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: AWS CloudWatch Log Group Deleted
enabled: true
severity: High
description: |-
  ## Goal
  Detect deletion of Amazon CloudWatch log groups. This may indicate an attempt to tamper with or disable logging and monitoring, thereby impairing defensive mechanisms and forensic visibility.

  ## Strategy
  Monitor AWS CloudTrail management events from `logs.amazonaws.com` with:
  * `eventName="DeleteLogGroup"`

  Focus on successful deletions of log groups that are expected to be long-lived or attached to critical workloads, security tooling, or compliance-related logging.

  ## Triage and Response
  * Confirm whether the deleted log group is associated with critical workloads (e.g. security services, production systems, audit logs).
  * Validate that the deletion aligns with an approved change request or maintenance window.
  * Review recent activity from the same principal and source IP for related attempts to weaken logging or monitoring (e.g. CloudTrail, Config, security tool logs).
  * If unapproved, treat as a high-priority event: preserve evidence, assess potential impact on visibility, and restore or recreate required logging configurations.
query_text: |-
  %ingest.source_type="aws:cloudtrail"
  eventSource="logs.amazonaws.com"
  eventName="DeleteLogGroup"
  | groupbycount(
  recipientAccountId,
  awsRegion,
  userIdentity.type,
  userIdentity.arn,
  requestParameters.logGroupName,
  sourceIPAddress
  )
  | where @q.count > 0
time_range_s: 3600
run_frequency_s: 300
event_sink_keys:
- high_severity_alerts
tags:
- source.aws
- domain.cloud
- domain.logging
- tactics.ta0005.defence_evasion
- techniques.t1562.008.impair_defences_disable_cloud_logs
- use_case.aws_logging
- use_case.cloudwatch_logs
context_fields:
- recipientAccountId
- awsRegion
- eventTime
- eventSource
- eventName
- requestParameters.logGroupName
- userIdentity.type
- userIdentity.arn
- userIdentity.accountId
- userIdentity.userName
- userIdentity.sessionContext.sessionIssuer.arn
- sourceIPAddress
- userAgent
- errorCode
- errorMessage
