# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: AWS S3 Bucket Made Public By ACL
enabled: true
severity: High
description: |-
  ## Goal
  Detect when an Amazon S3 bucket is made publicly accessible via Access Control Lists (ACL). This could indicate an attempt to expose sensitive data or impair defenses by making the bucket open to unauthorized users.

  ## Strategy
  Monitor AWS CloudTrail management events from `s3.amazonaws.com` for:
  * `PutBucketAcl`

  and identify events where the ACL grants access to either of the global groups:
  * `http://acs.amazonaws.com/groups/global/AuthenticatedUsers`
  * `http://acs.amazonaws.com/groups/global/AllUsers`

  These grant URIs indicate that the bucket ACL allows access to a broad or public audience, which may expose sensitive data.

  ## Triage and Response
  * Confirm whether the bucket was intentionally made public (for example, a static website or public data set) or if this was accidental/malicious.
  * Identify the affected bucket and review the data it contains for sensitivity (PII, credentials, financial data, etc.).
  * If unapproved, immediately remediate by tightening the ACL and/or using S3 Block Public Access controls.
  * Review other configuration changes and access patterns involving the same bucket and principal for additional misconfiguration or data exposure.
query_text: |-
  %ingest.source_type="aws:cloudtrail"
  eventSource:"s3.amazonaws.com"
  eventName:"PutBucketAcl"
  not errorCode:*
  requestParameters.AccessControlPolicy.AccessControlList.Grant.Grantee.URI:(
  "http://acs.amazonaws.com/groups/global/AuthenticatedUsers"
  "http://acs.amazonaws.com/groups/global/AllUsers"
  )
  | groupbycount(
  recipientAccountId,
  requestParameters.bucketName,
  userIdentity.arn,
  awsRegion
  )
  | where @q.count > 0
time_range_s: 3600
run_frequency_s: 3600
event_sink_keys:
- high_severity_alerts
tags:
- source.aws
- domain.cloud
- domain.s3
- tactics.ta0005.defense_evasion
- tactics.ta0009.collection
- techniques.t1562.impair_defenses
- use_case.aws_s3
- use_case.public_bucket
context_fields:
- recipientAccountId
- awsRegion
- eventSource
- eventName
- eventTime
- sourceIPAddress
- userAgent
- userIdentity.type
- userIdentity.arn
- userIdentity.accountId
- requestParameters.bucketName
- requestParameters.AccessControlPolicy.AccessControlList.Grant.Grantee.URI
- requestParameters.AccessControlPolicy.AccessControlList.Grant.Permission
- additionalEventData
