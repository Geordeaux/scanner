# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: AWS Password Policy Change
description: |-
  ## Goal
  Detects when an existing password policy is updated or deleted in an AWS account. This could indicate an attempt to weaken security settings, which could be exploited by attackers.

  ## Strategy
  Monitor AWS CloudTrail events for actions that modify or delete the account password policy, such as `UpdateAccountPasswordPolicy` and `DeleteAccountPasswordPolicy`. If these actions are detected, trigger an alert.

  ## Triage and Response
  Investigate further to confirm whether the changes were authorized. Verify that no unauthorized modifications have been made to the AWS password policy. Consider reviewing access controls and logging to ensure no unauthorized changes have occurred.
enabled: true
severity: Medium
query_text: |-
  %ingest.source_type="aws:cloudtrail"
  metadata.vendor_name:AMAZON
  metadata.product_name:"AWS CloudTrail"
  (
  metadata.product_event_type:UpdateAccountPasswordPolicy or
  metadata.product_event_type:DeleteAccountPasswordPolicy
  )
  security_result.action:ALLOW
  | groupbycount(
  additional.fields.recipientAccountId,
  principal.user.user_display_name,
  metadata.product_event_type
  )
  | where @q.count > 0
time_range_s: 3600
run_frequency_s: 3600
event_sink_keys:
- medium_severity_alerts
tags:
- source.aws
- domain.cloud
- domain.iam
- tactics.ta0007.discovery
- techniques.t1201.password_policy_discovery
