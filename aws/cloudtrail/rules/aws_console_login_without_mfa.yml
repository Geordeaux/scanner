# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: AWS Console Login Without MFA
enabled: true
severity: Low
description: "## Goal\nDetect AWS Management Console logins where Multi-Factor Authentication (MFA) was not used. This highlights interactive access relying solely on username and password, increasing the risk of unauthorised access.\n\n## Strategy\nMonitor AWS CloudTrail management events from `signin.amazonaws.com` with:\n* `eventName=\"ConsoleLogin\"`\n* `responseElements.ConsoleLogin=\"Success\"`\n* `additionalEventData.MFAUsed=\"No\"`\n\nThis captures successful console logins that did not use MFA (for both IAM users and, critically, the root account).\n\n## Triage and Response\n* Confirm whether the account is expected to be able to log in without MFA (for most organisations this should be \u201Cno\u201D, especially for root and privileged users).\n* Review the user\u2019s role and privileges; prioritise investigation of administrative or break-glass accounts.\n* Correlate with recent activity from the same principal and source IP for signs of suspicious behaviour (policy changes,\
  \ key creation, logging changes, etc.).\n* If the login is not explicitly approved, require MFA enrolment or disable console access for the user, depending on policy.\n* For root logins without MFA, treat as a high-priority issue and enforce immediate hardening (MFA, access key review, password rotation, and broader compromise assessment)."
query_text: |-
  %ingest.source_type="aws:cloudtrail"
  eventSource="signin.amazonaws.com"
  eventName="ConsoleLogin"
  responseElements.ConsoleLogin="Success"
  additionalEventData.MFAUsed="No"
  | groupbycount(
  recipientAccountId,
  userIdentity.type,
  userIdentity.arn,
  sourceIPAddress
  )
  | where @q.count > 0
time_range_s: 3600
run_frequency_s: 300
event_sink_keys:
- low_severity_alerts
tags:
- source.aws
- domain.cloud
- domain.authn
- tactics.ta0001.initial_access
- techniques.t1078.004.valid_accounts_cloud_accounts
- use_case.aws_authentication
- use_case.mfa_hardening
context_fields:
- recipientAccountId
- awsRegion
- eventTime
- eventSource
- eventName
- userIdentity.type
- userIdentity.arn
- userIdentity.accountId
- userIdentity.userName
- userIdentity.sessionContext.sessionIssuer.arn
- sourceIPAddress
- userAgent
- additionalEventData.MFAUsed
- responseElements.ConsoleLogin
