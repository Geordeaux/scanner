# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: AWS IAM Access Analyzer Deleted
enabled: true
severity: Low
description: |-
  ## Goal
  Detects when an AWS IAM Access Analyzer is deleted. This may indicate an attempt to impair defences by disabling or weakening cloud visibility.

  ## Strategy
  Monitor AWS CloudTrail management events from:
  * `eventSource: "access-analyzer.amazonaws.com"`
  * `eventName: "DeleteAnalyzer"`

  Any successful `DeleteAnalyzer` call should be treated as a notable event, as it removes an analyser that can surface cross-account and external access risks.

  ## Triage and Response
  * Identify which account and region the analyser belonged to, and which principal performed the deletion.
  * Confirm whether there is an approved change request or maintenance activity covering the deletion.
  * Check whether other security or logging controls (for example, GuardDuty, Config, CloudTrail) have also been modified in the same time window.
  * If the action is not clearly authorised:
    * Treat as a potential defence-evasion attempt.
    * Review recent IAM activity by the same principal and IP address (role changes, policy updates, key creation, and so on).
    * Consider restoring or recreating the analyser and tightening permissions around `access-analyzer.amazonaws.com`.
    * Escalate to incident response for further investigation.
query_text: |-
  %ingest.source_type="aws:cloudtrail"
  eventSource:"access-analyzer.amazonaws.com"
  eventName:"DeleteAnalyzer"
time_range_s: 3600
run_frequency_s: 3600
event_sink_keys:
- low_severity_alerts
tags:
- source.aws
- domain.cloud
- domain.identity_and_access
- tactics.ta0005.defence_evasion
- techniques.t1562.impair_defences
- use_case.iam_access_analyzer
- use_case.cloud_audit
context_fields:
- userIdentity.type
- userIdentity.arn
- userIdentity.userName
- sourceIPAddress
- userAgent
- awsRegion
- requestParameters
- responseElements
- recipientAccountId
- eventID
- eventTime
