# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: AWS Backup Plan Deleted
enabled: true
severity: Low
description: |-
  ## Goal
  Detect deletions of AWS Backup Plans or Backup Selections.

  ## Strategy
  Monitor AWS CloudTrail management events from the AWS Backup service for:
  * `DeleteBackupPlan`
  * `DeleteBackupSelection`

  Deletion of backup plans or selections may:
  * Be part of legitimate lifecycle or environment clean-up, or
  * Represent attempts to inhibit system recovery and resilience.

  ## Triage and Response
  * Confirm whether the deletion was requested and approved (change ticket, runbook, or maintenance window).
  * Validate that the initiating principal is authorised to manage backups for the affected account or environment.
  * If unapproved, treat as a potential attempt to weaken recovery capability, assess blast radius, and consider restoring required plans or selections from infrastructure-as-code or backups.
query_text: |-
  %ingest.source_type="aws:cloudtrail"
  eventSource="backup.amazonaws.com"
  eventName:(
  "DeleteBackupPlan"
  "DeleteBackupSelection"
  )
  and not errorCode:*
  | stats
  min(timestamp) as firstTime,
  max(timestamp) as lastTime,
  count() as eventCount
  by
  recipientAccountId,
  userIdentity.arn,
  eventSource,
  eventName,
  awsRegion,
  requestParameters.backupPlanId,
  requestParameters.backupPlanName,
  requestParameters.selectionId
time_range_s: 3600
run_frequency_s: 300
event_sink_keys:
- low_severity_alerts
tags:
- source.aws
- domain.cloud
- tactics.ta0040.impact
- techniques.t1490.inhibit_system_recovery
- use_case.aws_backup
- use_case.resilience
context_fields:
- recipientAccountId
- userIdentity.arn
- eventSource
- eventName
- awsRegion
- sourceIPAddress
- userAgent
- requestParameters.backupPlanId
- requestParameters.backupPlanName
- requestParameters.selectionId
- eventID
- eventTime
