# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: AWS Account Leaving Or Removed From The Organisation
enabled: true
severity: Medium
description: |-
  ## Goal
  Detect when an AWS account attempts to leave, or is removed from, the AWS Organisation.

  ## Strategy
  Monitor AWS CloudTrail management events for:
  * `LeaveOrganization`
  * `RemoveAccountFromOrganization`

  These actions may represent:
  * Legitimate administrative account restructuring, or
  * Malicious attempts to evade central governance, SCP enforcement, monitoring, and logging.

  ## Triage and Response
  * Validate whether the action aligns with an approved change request.
  * Confirm the initiating principal is authorised to perform Organisation-level changes.
  * Escalate immediately if unapproved, as this may indicate a compromised principal attempting to remove an account from governance.
query_text: |-
  %ingest.source_type="aws:cloudtrail"
  eventSource="organizations.amazonaws.com"
  eventName:(
  "LeaveOrganization"
  "RemoveAccountFromOrganization"
  )
  | groupbycount(cloud.account.id, userIdentity.arn)
  | where @q.count > 0
time_range_s: 3600
run_frequency_s: 300
event_sink_keys:
- medium_severity_alerts
tags:
- source.aws
- domain.cloud
- tactics.ta0005.defense_evasion
- techniques.t1562.impair_defenses
- use_case.aws_organisations
- use_case.governance
