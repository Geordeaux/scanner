# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: AWS GuardDuty EKS Anonymous Access Granted
description: |-
  ## Goal
  Detects when anonymous access is granted to the Kubernetes API server.

  ## Strategy
  Monitor GuardDuty findings for `Policy:Kubernetes/AnonymousAccessGranted`. This configuration allows unauthenticated users to access the API, which is a major security risk.

  ## Triage and Response
  1. Identify the cluster and the role binding granting anonymous access.
  2. Remove the role binding immediately.
  3. Audit logs for any unauthenticated access during the exposure period.
enabled: true
severity: High
query_text: "%ingest.source_type:aws_guardduty\nmetadata.product_event_type:\"Policy:Kubernetes/AnonymousAccessGranted\" "
time_range_s: 3600
run_frequency_s: 300
event_sink_keys:
- high_severity_alerts
tags:
- guardduty
- aws
- eks
- kubernetes
- misconfiguration
