# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: AWS GuardDuty Root Credential Usage
description: |-
  ## Goal
  Detects usage of the AWS root account credentials.

  ## Strategy
  Monitor GuardDuty findings for `Policy:IAMUser/RootCredentialUsage`. The root account has unrestricted access to all resources in the AWS account and its usage should be strictly monitored and limited to specific tasks that require it.

  ## Triage and Response
  1. Verify if the root account usage was authorized and expected.
  2. If unauthorized, assume the root account is compromised.
  3. Change the root password and rotate MFA immediately.
  4. Check for any unauthorized resources created or modified.
enabled: true
severity: Critical
query_text: "%ingest.source_type:aws_guardduty\nmetadata.product_event_type:\"Policy:IAMUser/RootCredentialUsage\" "
time_range_s: 3600
run_frequency_s: 300
event_sink_keys:
- critical_severity_alerts
tags:
- guardduty
- aws
- root_account
