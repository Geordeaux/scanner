# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: AWS GuardDuty IAM User Network Permissions
description: |-
  ## Goal
  Detects when an IAM user modifies network permissions to potentially allow unauthorized access.

  ## Strategy
  Monitor GuardDuty findings for `Persistence:IAMUser/NetworkPermissions`. This finding indicates that an IAM user has modified security groups, NACLs, or route tables in a way that weakens network security.

  ## Triage and Response
  1. Identify the user and the specific changes made.
  2. Verify if the changes were authorized.
  3. If unauthorized, revert the changes immediately.
  4. Revoke the user's permissions and investigate for compromise.
enabled: true
severity: High
query_text: "%ingest.source_type:aws_guardduty\nmetadata.product_event_type:\"Persistence:IAMUser/NetworkPermissions\" "
time_range_s: 3600
run_frequency_s: 300
event_sink_keys:
- high_severity_alerts
tags:
- guardduty
- aws
- iam
- persistence
