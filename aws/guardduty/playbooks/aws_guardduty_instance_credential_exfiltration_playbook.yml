name: AWS GuardDuty Instance Credential Exfiltration Playbook
description: Detects when temporary AWS credentials created for an EC2 instance are used from an external IP address.
severity: Critical
steps:
- name: Investigation
  description: Monitor GuardDuty findings for `UnauthorizedAccess:IAMUser/InstanceCredentialExfiltration`. This finding is triggered when instance profile credentials are used from an IP address other than the EC2 instance they were issued to.
- name: Triage
  description: '1. Confirm if the IP address belongs to a legitimate user or system (e.g., a developer testing locally).

    2. If unauthorized, this confirms the instance credentials have been stolen.

    3. Revoke the credentials immediately.

    4. Investigate how the credentials were stolen (SSRF, RCE, etc.).'
- name: Remediation
  description: Follow the Triage steps to contain and remediate.
