# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: Secret Exposed and not Quarantined
description: |-
  ## Goal
  The rule detects when a GitHub Secret Scan detects an exposed secret, which is not followed by the expected quarantine operation in AWS.  When you make a repository public, or push changes to a public repository, GitHub always scans the code for secrets that match partner patterns. Public packages on the npm registry are also scanned. If secret scanning detects a potential secret, we notify the service provider who issued the secret. The service provider validates the string and then decides whether they should revoke the secret, issue a new secret, or contact you directly. Their action will depend on the associated risks to you or them.

  ## Strategy
  Monitor logs for the specific sequence of events described.

  ## Triage and Response
  1. Identify the user and the sequence of actions.
  2. Verify if the actions are authorized and business-justified.
  3. If unauthorized, revert changes and suspend the user.
enabled: true
severity: High
query_text: |-
  %ingest.source_type:github
  action:secret_scanning_alert
time_range_s: 3600
run_frequency_s: 300
event_sink_keys:
- high_severity_alerts
tags:
- 'Unsecured Credentials: Credentials in Files'
- panther_migration
