# schema: https://scanner.dev/schema/scanner-threat-hunting-query.v1.json
name: Google Compute Engine network route created or modified
description: |-
  Detect when a firewall rule is created or modified.
query_text: |-
  %ingest.source_type:gcp
  protoPayload.methodName:(beta.compute.routes.insert beta.compute.routes.patch)
  | groupbycount(project_id, data.protoPayload.resourceName, protoPayload.authenticationInfo.principalEmail)
  | where @q.count > 0
tags:
- source.gcp
- techniques.t1578.modify_cloud_compute_infrastructure
- tactics.ta0005.defense_evasion
