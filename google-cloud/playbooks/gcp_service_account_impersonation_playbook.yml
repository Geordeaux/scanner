name: GCP Service Account Impersonation Playbook
description: Detects usage of Service Account impersonation.
severity: High
steps:
- name: Investigation
  description: Monitor Google Cloud audit logs for `iam.serviceAccounts.actAs` permission checks or `GenerateAccessToken` calls. Attackers may impersonate service accounts to elevate privileges.
- name: Triage
  description: '1. Identify the user and the target service account.

    2. Verify if the impersonation is authorized for this user.

    3. Revoke permissions immediately if unauthorized.'
- name: Remediation
  description: Follow the Triage steps to contain and remediate.
