# schema: https://scanner.dev/schema/scanner-threat-hunting-query.v1.json
name: Cloudflare Bot Requests
description: |-
  Detect bots making HTTP requests at a high volume, which
  may indicate automated attacks or scraping activities.

  This rule uses the Cloudflare Bot Score, which is a score
  from 1 to 99 that indiciates how likely the request came
  came from a bot. Scores of 1 through 29 are likely
  automated requests.

  The default threshold is 600 requests per 5 minutes (2 RPS).
query_text: |-
  %ingest.source_type:cloudflare
  BotScore < 30 and BotScore > 0
  | groupbycount(ClientIP)
  | where @q.count > 600
tags:
- tactics.ta0040.impact
- techniques.t1499.endpoint_denial_of_service
- source.cloudflare
