# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: Cloudflare Credential Stuffing Detected
description: |-
  ## Goal
  Detects potential credential stuffing attacks based on high volumes of login failures.

  ## Strategy
  Monitor for a high rate of 401 or 403 responses on login endpoints from a single IP or subnet.

  ## Triage and Response
  1. Identify the source IP and target endpoint.
  2. Check if the IP is rotating user agents.
  3. Enable Rate Limiting or Bot Management on the login path.
enabled: true
severity: High
query_text: "%ingest.source_type:cloudflare\nClientRequestPath:\"/login\" OR ClientRequestPath:\"/signin\"\nEdgeResponseStatus:401 OR EdgeResponseStatus:403\n| count(ClientIP) > 50 "
time_range_s: 3600
run_frequency_s: 300
event_sink_keys:
- high_severity_alerts
tags:
- cloudflare
- waf
- credential_stuffing
