# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: Atlassian Confluence Anonymous Access Enabled
description: |-
  ## Goal
  Detects when anonymous access is enabled for a Confluence space or globally.
  This allows unauthenticated users to view content, potentially leaking sensitive information.

  ## Strategy
  1. Determine if this was authorized (e.g., for a public knowledge base).
  2. Check if sensitive content is exposed.

  ## Triage and Response
  1. Identify the user (`attributes.actor.email`) who enabled anonymous access.
  2. Identify the space or global setting affected.
  1. If unauthorized, disable anonymous access immediately.
  2. Review access logs to see if external IPs accessed the content.
enabled: true
severity: Critical
query_text: |-
  %ingest.source_type:atlassian
  attributes.action:global_permission_added
  attributes.context.attributes.permission:USE
  attributes.context.attributes.groupName:null
  | groupbycount(attributes.actor.email)
  | where @q.count > 0
time_range_s: 300
run_frequency_s: 60
event_sink_keys:
- critical_severity_alerts
tags:
- tactics.ta0001.initial_access
- techniques.t1190.exploit_public_facing_application
- source.atlassian
